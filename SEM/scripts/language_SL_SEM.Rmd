---
title: "language_SL_SEM"
output: html_notebook
---

```{r}
library(tidyverse)
library(lavaan)
library(broom)
```

```{r}
#df <- read.csv("~/GitHub/lendulet_language_SL/SEM/dataframes/SEM_df.csv")
df = read.csv(readline("Path of dataframe (e.g., C:/experiment/df.csv): "))
df[, 17:33] = sapply(df[, 17:33], scale)
df[, 35:56] = sapply(df[, 35:56], scale)
df[, 58:74] = sapply(df[, 58:74], scale)
```

```{r}
#latent variables

SL_RT =~ SEGM_AL_medRT_TRN3_RND4 + SEGM_AL_medRT_RND4_REC5
SL_ACC =~ SEGM_AL_ACC_RND4_REC5 + SEGM_AL_ACC_TRN3_RND4
SL_offline =~ SEGM_AL_2AFC_trigram + SEGM_AL_SEGM_prod_data + AGL_2AFC_phr + AGL_2AFC_sent + AGL_prod

PS =~ PROC_SPEED_vis_RT_med + PROC_SPEED_ac_RT_med
DS =~ digit_span_forward_span + digit_span_backward_span
nback =~ n_back_nback_1_dprime + n_back_nback_2_dprime + n_back_nback_3_dprime
stroop =~ stroop_RT_score

offline =~ MENYET_mean_ACC_all + trog_pragm_ACC_mean
reading =~ OMR_read_syls + selfpaced_target_RT_diff_GP + selfpaced_target_RT_diff_sertes

# dependent regression
offline ~ b11*nback + b12*DS + b13*PS + b14*stroop + c11*SL_RT + c12*SL_ACC + c13*SL_offline
reading ~ b21*nback + b22*DS + b23*PS + b24*stroop + c21*SL_RT + c22*SL_ACC + c23*SL_offline

# mediator regression
nback ~ a11*SL_RT + a12*SL_ACC + a13*SEGM_AL_2AFC_trigram
DS ~ a21*SL_RT + a22*SL_ACC + a23*SL_offline
PS ~ a31*SL_RT + a32*SL_ACC + a33*SL_offline
stroop ~ a41*SL_RT + a42*SL_ACC + a43*SL_offline

# mediator residual covariance
nback ~~ DS
nback ~~ PS
DS ~~ PS
nback ~~ stroop
DS ~~ stroop
PS ~~ stroop

# dependent residual covariance
offline ~~ reading

# effect decomposition
# y1 ~ x1
ind_x1_m1_y1 := a11*b11
ind_x1_m2_y1 := a21*b12
ind_x1_m3_y1 := a31*b13
ind_x1_m4_y1 := a41*b14
ind_x1_y1 := ind_x1_m1_y1 + ind_x1_m2_y1 + ind_x1_m3_y1 + ind_x1_m4_y1
tot_x1_y1 := ind_x1_y1 + c11

# y1 ~ x2
ind_x2_m1_y1 := a12*b11
ind_x2_m2_y1 := a22*b12
ind_x2_m3_y1 := a32*b13
ind_x2_m4_y1 := a42*b14
ind_x2_y1 := ind_x2_m1_y1 + ind_x2_m2_y1 + ind_x2_m3_y1 + ind_x2_m4_y1
tot_x2_y1 := ind_x2_y1 + c12

# y1 ~ x3
ind_x3_m1_y1 := a13*b11
ind_x3_m2_y1 := a23*b12
ind_x3_m3_y1 := a33*b13
ind_x3_m4_y1 := a43*b14
ind_x3_y1 := ind_x3_m1_y1 + ind_x3_m2_y1 + ind_x3_m3_y1 + ind_x3_m4_y1
tot_x3_y1 := ind_x3_y1 + c13

# y2 ~ x1
ind_x1_m1_y2 := a11*b21
ind_x1_m2_y2 := a21*b22
ind_x1_m3_y2 := a31*b23
ind_x1_m4_y2 := a41*b24
ind_x1_y2 := ind_x1_m1_y2 + ind_x1_m2_y2 + ind_x1_m3_y2 + ind_x1_m4_y2
tot_x1_y2 := ind_x1_y2 + c21

# y2 ~ x2
ind_x2_m1_y2 := a12*b21
ind_x2_m2_y2 := a22*b22
ind_x2_m3_y2 := a32*b23
ind_x2_m4_y2 := a42*b24
ind_x2_y2 := ind_x2_m1_y2 + ind_x2_m2_y2 + ind_x2_m3_y2 + ind_x2_m4_y2
tot_x2_y2 := ind_x2_y2 + c22

# y2 ~ x3
ind_x3_m1_y2 := a13*b21
ind_x3_m2_y2 := a23*b22
ind_x3_m3_y2 := a33*b23
ind_x3_m4_y2 := a43*b24
ind_x3_y2 := ind_x3_m1_y2 + ind_x3_m2_y2 + ind_x3_m3_y2 + ind_x3_m4_y2
tot_x3_y2 := ind_x3_y2 + c23


```