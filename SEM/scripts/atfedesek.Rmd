---
title: "R Notebook"
output: html_notebook
---

```{r}
library(tidyverse)
```

A változók átfedéseinek kiszámítása

```{r}

dataframe <- read.csv("C:/Users/Kriszti/GitHub/lendulet_language_SL/SEM/dataframes/SEM_df.csv", header = TRUE)

overlaps = data.frame(matrix(nrow = 2809, ncol = 5))
colnames(overlaps) = c("var1", "var2", "all_overlap", "adult_overlap", "children_overlap")

n = 1

for (var1 in colnames(dataframe)[16:68])
{
  for (var2 in colnames(dataframe)[16:68])
    {
      overlaps$var1[n] = var1
      overlaps$var2[n] = var2
      overlaps$all_overlap[n] = nrow(
        dataframe %>% filter(!is.na(dataframe[,var1]) & !is.na(dataframe[,var2]))
        )
      overlaps$adult_overlap[n] = nrow(
        dataframe %>% filter(!is.na(dataframe[,var1]) & !is.na(dataframe[,var2]) & age_years > 14)
        )
      overlaps$children_overlap[n] = nrow(
        dataframe %>% filter(!is.na(dataframe[,var1]) & !is.na(dataframe[,var2]) & age_years <= 14)
        )
      n = n + 1
    }
}

```

Meg kell nézni, hogy mely változóknál van 70-nél kisebb átfedés:

```{r}

less_than_70 = overlaps %>% 
  filter(all_overlap < 70)

```


Gyanús változók?

Ha a 100-nál kevesebb átfedéssel rendelkező változókat kivesszük, akkor az érinti 
- a dichotikus hallgatási változókat,
- a PROC_SPEED_acdec változót,
- a recvoc változót,
- a SEGM_VN kezdetű változókat, 
- és a NAD változóit.


Látens változók közötti átfedések

```{r}
coverage = dataframe %>% 
  mutate(
    `SEGM RT` = mean(SEGM_AL_medRT_TRN3_RND4, SEGM_AL_medRT_RND4_REC5, na.rm = TRUE),
    `SEGM 2AFC` = mean(SEGM_AL_2AFC_bigram, SEGM_AL_2AFC_trigram, na.rm = TRUE),
    `SEGM production` = SEGM_AL_SEGM_prod_data,
    `AGL` = mean(AGL_2AFC_sent, AGL_prod, na.rm = TRUE),
    `AGL phrase` = AGL_2AFC_phr,
    `grammatical sensitivity` = MENYET_mean_ACC_all,
    `pragmatic comprehension` = trog_pragm_ACC_mean,
    `self-paced reading` = mean(selfpaced_target_RT_diff_GP, selfpaced_target_RT_diff_sertes, na.rm = TRUE),
    `predictive sentence processing` = predictive_RT_score,
    `one minute reading` = OMR_read_syls,
    `processing speed` = mean(PROC_SPEED_vis_RT_med, PROC_SPEED_ac_RT_med, na.rm = TRUE),
    `visual decision speed` = PROC_SPEED_vis_dec_RT_med,
    `digit span` = mean(digit_span_forward_span, digit_span_backward_span, na.rm = TRUE),
    `nback` = mean(n_back_nback_2_dprime, n_back_nback_3_dprime, na.rm = TRUE),
    `Stroop` = stroop_RT_score,
    `Simon` = simon_RT_score
    )
```

