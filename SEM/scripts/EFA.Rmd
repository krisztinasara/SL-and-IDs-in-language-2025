---
title: "EFA"
output: html_notebook
---

```{r}
library(tidyverse)
library(psych)
library(GPArotation)
```

```{r}
df = read.csv(readline("Path of dataframe (e.g., C:/experiment/df.csv): "))
```

# 1. EFA with 100<= sample size

## 1.1. Statistical learning measures

(Variables are in different rows to be able to be removed by commenting them out)

Scree plot
```{r}
SL_100plus_cor = df %>% 
  select(
    #SEGM_AL_medRT_train,
    SEGM_AL_medRT_TRN3_RND4,
    SEGM_AL_medRT_RND4_REC5,
    #SEGM_AL_ACC_train,
    SEGM_AL_ACC_TRN3_RND4,
    SEGM_AL_ACC_RND4_REC5,
    #SEGM_AL_2AFC_bigram,
    SEGM_AL_2AFC_trigram,
    SEGM_AL_SEGM_prod_data,
    #AGL_ACC_train,
    AGL_2AFC_phr,
    AGL_2AFC_sent, AGL_prod
  ) %>% 
  cor(use = "pairwise.complete.obs")
SL_100plus_cor %>% 
  scree(factors = FALSE)
```

Parallel analyses plot
```{r}
df %>% 
  select(
    #SEGM_AL_medRT_train,
    SEGM_AL_medRT_TRN3_RND4,
    SEGM_AL_medRT_RND4_REC5,
    #SEGM_AL_ACC_train,
    SEGM_AL_ACC_TRN3_RND4,
    SEGM_AL_ACC_RND4_REC5,
    #SEGM_AL_2AFC_bigram,
    SEGM_AL_2AFC_trigram,
    SEGM_AL_SEGM_prod_data,
    #AGL_ACC_train,
    AGL_2AFC_phr,
    AGL_2AFC_sent,
    AGL_prod
  ) %>% 
    fa.parallel(fm="ml")
```

Factor building
```{r}
SL_EFA_100plus = df %>% 
  select(
    #SEGM_AL_medRT_train,
    SEGM_AL_medRT_TRN3_RND4,
    SEGM_AL_medRT_RND4_REC5,
    #SEGM_AL_ACC_train,
    SEGM_AL_ACC_TRN3_RND4,
    SEGM_AL_ACC_RND4_REC5,
    #SEGM_AL_2AFC_bigram,
    SEGM_AL_2AFC_trigram,
    SEGM_AL_SEGM_prod_data,
    #AGL_ACC_train,
    AGL_2AFC_phr,
    AGL_2AFC_sent,
    AGL_prod
  ) %>% 
  fa(nfactors = 3, fm ="ml", rotate = "Promax")
```

```{r}
summary(SL_EFA_100plus)
```

```{r}
SL_EFA_100plus$loadings
```

## 1.2. General cognitive measures

Scree plot
```{r}
GC_100plus_cor = df %>% 
  select(
    PROC_SPEED_vis_RT_med,
    PROC_SPEED_ac_RT_med,
    PROC_SPEED_vis_dec_RT_med,
    digit_span_forward_span,
    digit_span_backward_span,
    n_back_nback_1_dprime,
    n_back_nback_2_dprime,
    n_back_nback_3_dprime,
    stroop_RT_score,
    stroop_ACC_score,
    simon_RT_score,
    simon_ACC_score
  ) %>% 
  cor(use = "pairwise.complete.obs")
GC_100plus_cor %>% 
  scree(factors = FALSE)
```

Parallel analyses plot
```{r}
df %>% 
  select(
    PROC_SPEED_vis_RT_med,
    PROC_SPEED_ac_RT_med,
    PROC_SPEED_vis_dec_RT_med,
    digit_span_forward_span,
    digit_span_backward_span,
    n_back_nback_1_dprime,
    n_back_nback_2_dprime,
    n_back_nback_3_dprime,
    stroop_RT_score,
    stroop_ACC_score,
    simon_RT_score,
    simon_ACC_score
  ) %>% 
    fa.parallel(fm="ml")

```

Factor building
```{r}
GC_EFA_100plus = df %>% 
  select(
    PROC_SPEED_vis_RT_med,
    PROC_SPEED_ac_RT_med,
    PROC_SPEED_vis_dec_RT_med,
    digit_span_forward_span,
    digit_span_backward_span,
    n_back_nback_1_dprime,
    n_back_nback_2_dprime,
    n_back_nback_3_dprime,
    stroop_RT_score,
    stroop_ACC_score,
    simon_RT_score,
    simon_ACC_score
  ) %>% 
  fa(nfactors = 3, fm ="ml", rotate = "Promax")
```

```{r}
summary(GC_EFA_100plus)
```

```{r}
GC_EFA_100plus$loadings
```
